# Capslian API Worker
# 部署前请执行: wrangler d1 create capslian-db 并替换下方 database_id
# R2: wrangler r2 bucket create capslian-assets
name = "capslian-api"
main = "src/index.ts"
compatibility_date = "2024-12-01"
workers_dev = true

[vars]
JWT_SECRET = "0123456789abcdef0123456789abcdef"

[[d1_databases]]
binding = "capslian_db"
database_name = "capslian-db"
database_id = "6265dde6-45ad-460d-bd7d-314f4e8abb56"
migrations_dir = "migrations"

# R2 is not enable
# [[r2_buckets]]
# binding = "ASSETS"
# bucket_name = "capslian-assets"

[durable_objects]
bindings = [
  { name = "CHAT", class_name = "ChatRoom", script_name = "capslian-api" }
]

[[migrations]]
tag = "v1"
new_sqlite_classes = ["ChatRoom"]
